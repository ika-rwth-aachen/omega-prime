
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ika-rwth-aachen.github.io/omega-prime/library/">
      
      
        <link rel="prev" href="../omega_prime_specification/">
      
      
        <link rel="next" href="../map_segmentation/map_segmentation/">
      
      
        
      
      
      <link rel="icon" href="../logo/omega-prime-no-text.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Overview - Omega-Prime</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#recordings-and-map-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Omega-Prime" class="md-header__button md-logo" aria-label="Omega-Prime" data-md-component="logo">
      
  <img src="../logo/omega-prime-no-text.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Omega-Prime
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Omega-Prime" class="md-nav__button md-logo" aria-label="Omega-Prime" data-md-component="logo">
      
  <img src="../logo/omega-prime-no-text.svg" alt="logo">

    </a>
    Omega-Prime
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    omega-prime
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../omega_prime_specification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Model & Specification
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Python Library
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Python Library
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recordings-and-map-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recordings and Map Data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Converters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Locator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../map_segmentation/map_segmentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Map Segmentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inroduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/tutorial_locator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Locator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/tutorial_metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/tutorial_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Map Segmentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recordings-and-map-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recordings and Map Data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Converters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Locator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Overview</h1>

<h2 id="recordings-and-map-data">Recordings and Map Data</h2>
<p>The omega-prime library has two major components, the <code>Recording</code> and the <code>Map</code>.
The <code>Recording</code> stores the dynamic object information and the map object.
A recording is a continuous traffic observation and usually corresponds to an OSI trace or an MCAP recording.
The dynamic object information is stored in the attribute <code>df</code> (for DataFrame) as a single polars DataFrame, where each row corresponds to the observation of a single moving object at a specific point in time.
A convenience function to access this data in an object oriented manner are the <code>MovingObject</code> stored in <code>moving_objects</code> attribute of the <code>Recording</code>.
For most operations, it is recommended to use the DataFrame stored in <code>df</code> directly, as polars provides a fast and flexible API for data manipulation.
See the <a href="https://docs.pola.rs/">Polars user guide</a> for more information on how to use polars DataFrames.
The object polygons for each timestamp are accessible as shapely objects in the <code>polygon</code> column or as <a href="https://github.com/Oreilles/polars-st"><code>polars_st</code></a> geometries in the <code>geometry</code> column.
It is recommended to make use of <code>polars_st</code> as much as possible instead of <code>shapely</code> since <code>polars_st</code> can utilize the benefits of using a DataFrame more effectively.</p>
<pre class="mermaid"><code>flowchart TB

    subgraph recording [Recording]
        rec_map[map]@{ shape: doc }
        df@{ shape: win-pane }
        moving_objects@{ shape: docs } 
    end
    df -.- moving_objects

    rec_map --&gt; map
    subgraph map [Map]
        lane_boundaries@{ shape: docs }
        lanes@{ shape: docs }
    end

    subgraph lane [Lane]
        centerline
        lane_polygon[polygon]
        right_boundary_id@{ shape: doc }
        left_boundary_id@{ shape: doc }
    end

    subgraph lane_boundary [LaneBoundary]
        polyline
    end
    lanes --&gt; lane
    lane_boundaries --&gt; lane_boundary
    right_boundary_id --&gt; lane_boundary
    left_boundary_id --&gt; lane_boundary
    polyline -.- lane_polygon

    subgraph moving_object [MovingObject]

    end
    moving_objects --&gt; moving_object</code></pre>
<p>The <code>Map</code> stores the static map information, i.e., lanes and lane boundaries.
Lanes and lane boundaries are derived form the ASAM OSI definition and are also corresponding to the concept of lanelets in Lanelet2.
When working with the map data in python, the geometries of the map are represented through polygons or polylines (for boundaries and centerlines) using <a href="https://shapely.readthedocs.io/en/stable/">shapely</a>.</p>
<p><code>MovingObject</code>, <code>Lane</code> and <code>LaneBoundary</code> each have types and additional information corresponding to ASAM OSI definitions.
The library uses <a href="https://github.com/ika-rwth-aachen/betterosi">betterosi</a> as a python implementation of ASAM OSI.</p>
<p>The omega-prime specification suggests the usage of ASAM OpenDRIVE maps as map data.
This is supported through the <code>MapOdr</code> subclass of <code>Map</code>. 
Additionally, this library provides subclasses for ASAM OSI maps through <code>MapOsi</code> and <code>MapOsiCenterline</code>, where the latter does not provide lane polygons and lane boundaries (which is needed for some datasets).
In the future, <code>MapLanelet</code> will provide support for Lanelet2 maps.
Thus, a key benefit of using this library is the unified interface to work with different map formats.</p>
<p>See <a href="../notebooks/tutorial/">Tutorials / Introduction</a> for examples of how to use omega-prime.</p>
<h2 id="converters">Converters</h2>
<p>The class <code>omega_prime.converters.DatasetConverter</code> aids in defining converters that transform existing data sources into the omega-prime format.
For guidance on how to implement your own converter you can have a look at the <code>LxdConverter</code>, which translates the <a href="https://levelxdata.com/">LevelXData</a> datasets into omega-prime.
Additionally, you can have a look at <a href="https://github.com/ika-rwth-aachen/omega-prime-trajdata">omega-prime-trajdata</a> to convert many motion prediction datasets into the omega-prime format.
Examples of datasets that can be converted with <code>omega-prime-trajdata</code> into omega-prime are <a href="https://www.nuscenes.org/nuplan">NuPlan</a>, <a href="https://www.nuscenes.org/">NuScene</a>, <a href="https://www.argoverse.org/av2.html">Argoverse2</a> and <a href="https://waymo.com/open/">Waymo Open Dataset - Motion</a>.
Here, the class <code>TrajdataConverter</code> implements the <code>DatasetConverter</code>.</p>
<p>Data that is available as ASAM OpenDRIVE and ASAM OSI traces does not need a conversion an can be directly used with <code>omega-prime</code>.
Many simulation tools such as <a href="https://github.com/esmini/esmini">esmini</a> or <a href="https://carla.org/">CARLA</a> through <a href="https://github.com/DLR-TS/Carla-OSI-Service">Carla-OSI-Service</a> support the logging of simulation data as OSI traces.
These can be directly read in and analyzed with the omega-prime library.</p>
<h2 id="locator">Locator</h2>
<p>The <code>Locator</code> uses the <code>Map</code> object to locate <code>MovingObject</code>s or any polygon or coordinate onto the <code>Lane</code>s of the map.
The <code>Locator</code> can assign lane occupancy to objects and derive s-t-coordinate (Frenet coordinates).</p>
<p>See <a href="../notebooks/tutorial_locator/">Tutorials / Locator</a> for examples of how to use the <code>Locator</code>.</p>
<h2 id="metrics">Metrics</h2>
<p>The <code>MetricsManager</code> makes use of <a href="https://docs.pola.rs/user-guide/concepts/lazy-api/#previewing-the-query-plan">Polars feature of lazy evaulation</a> to enable efficient computation of many, possible, dependent metrics.
The metrics computation can be defined by subclassing <code>Metric</code> or, more easily by using the decorator <code>@omega_prime.metrics.metric</code> a function that computes your metric based on the <code>Recording.df</code>.
Moreover, the <code>Metric</code> lets you define dependencies between metrics, e.g., <code>distance_traveled</code> needs to be computed to compute <code>timegaps</code>. 
The <code>MetricsManager</code> then handles the dependencies automatically, and makes sure only the things you actually need are computed.</p>
<p>See <a href="../notebooks/tutorial_metrics/">Tutorials / Metrics</a> for examples of how to define and use the metric utilities.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.instant.preview", "toc.follow", "search.suggest", "search.highlight", "navigation.tracking", "navigation.sections"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>